language: go

sudo: required

go:
  - "1.11"

git:
  depth: 3
  quiet: true

env:
  - GO_ENV=test

services:
  - postgresql

addons:
  postgresql: "9.6"

before_script:
  - psql -c 'create database invitation_test;' -U postgres
  - mkdir -p $TRAVIS_BUILD_DIR/public/assets

go_import_path: github.com/invitation

install:
  - go get github.com/gobuffalo/buffalo/buffalo
  - go get github.com/gobuffalo/suite
  - go get $(go list ./... | grep -v /vendor/)

script: buffalo test -v -coverprofile=c.out ./...

after_script:
  - go tool cover -func=c.out
  - cat ${TRAVIS_HOME}/gopath/log/invitation-factory.log